dist: xenial

language: minimal

script:
  - sudo add-apt-repository -y ppa:beineri/opt-qt-5.12.3-xenial
  - sudo apt-get update
  - sudo apt-get install libgl-dev
  - sudo apt install python3 python3-pip
  - pip3 install --user jinja2
  # todo install only what is needed
  - sudo apt install qt512base qt512serialport qt512-meta-minimal
  - mkdir -p build
  - cd build
  - cmake ..
  - make -j$(nproc)
  - make fix-ui
  - make -j$(nproc)
  - wget -c -nv "https://github.com/probonopd/linuxdeployqt/releases/download/continuous/linuxdeployqt-continuous-x86_64.AppImage"
  - chmod a+x linuxdeployqt-continuous-x86_64.AppImage
  - ldd open-esc-qt
  - ls /opt/qt512/lib/
  - cp ../open-esc-qt.desktop .
  - ./linuxdeployqt-continuous-x86_64.AppImage open-esc-qt -appimage
